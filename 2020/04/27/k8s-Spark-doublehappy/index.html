<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>k8s-Spark-doublehappy | DoubleHappy or Jepson</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="Spark ON K8SSpark on K8s 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192">
<meta property="og:type" content="article">
<meta property="og:title" content="k8s-Spark-doublehappy">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2020&#x2F;04&#x2F;27&#x2F;k8s-Spark-doublehappy&#x2F;index.html">
<meta property="og:site_name" content="DoubleHappy or Jepson">
<meta property="og:description" content="Spark ON K8SSpark on K8s 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192">
<meta property="og:locale" content="en">
<meta property="og:image" content="https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200211152754486.png?x-oss-process=image&#x2F;watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200211154658637.png?x-oss-process=image&#x2F;watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200211162525671.png?x-oss-process=image&#x2F;watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70">
<meta property="og:updated_time" content="2020-04-27T09:13:16.921Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;20200211152754486.png?x-oss-process=image&#x2F;watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70">
  
    <link rel="alternate" href="/atom.xml" title="DoubleHappy or Jepson" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/default-avatar.jpg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/highlight.css">
</head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="图片来自网络">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/archives" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-k8s-Spark-doublehappy" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      k8s-Spark-doublehappy
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/2020/04/27/k8s-Spark-doublehappy/" class="article-date">
  <time datetime="2020-04-27T09:07:46.187Z" itemprop="datePublished">2020-04-27</time>
</a>
    
    
  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h2 id="Spark-ON-K8S"><a href="#Spark-ON-K8S" class="headerlink" title="Spark ON K8S"></a>Spark ON K8S</h2><p><a href="http://spark.apache.org/docs/latest/running-on-kubernetes.html" target="_blank" rel="noopener">Spark on K8s</a><br><img src="https://img-blog.csdnimg.cn/20200211152754486.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br></pre></td><td class="code"><pre><span class="line">k8s 数据存储是 etcd（生产上 这个 etcd 要做集群的）</span><br><span class="line"></span><br><span class="line">The Kubernetes scheduler is currently experimental. </span><br><span class="line">spark on k8s 是实验阶段 所以生产上 没有使用 只是测试 </span><br><span class="line"></span><br><span class="line">环境准备：</span><br><span class="line">1.下载Spark</span><br><span class="line">wget https://archive.apache.org/dist/spark/spark-2.4.3/spark-2.4.3-bin-hadoop2.6.tgz</span><br><span class="line">tar -xzvf spark-2.4.3-bin-hadoop2.6.tgz -C /opt/</span><br><span class="line">mv /opt/spark-2.4.3-bin-hadoop2.6 /opt/spark   </span><br><span class="line"><span class="built_in">cd</span>  /opt/spark</span><br><span class="line"></span><br><span class="line">注意：一定是 /opt/spark 目录下 ！！！</span><br><span class="line">[root@container01 spark]<span class="comment"># pwd</span></span><br><span class="line">/opt/spark</span><br><span class="line">[root@container01 spark]<span class="comment"># ll</span></span><br><span class="line">total 128</span><br><span class="line">drwxr-xr-x 2 1000 1000  4096 May  1  2019 bin</span><br><span class="line">drwxr-xr-x 2 1000 1000  4096 May  1  2019 conf</span><br><span class="line">drwxr-xr-x 5 1000 1000  4096 May  1  2019 data</span><br><span class="line">drwxr-xr-x 4 1000 1000  4096 May  1  2019 examples</span><br><span class="line">drwxr-xr-x 2 1000 1000 12288 May  1  2019 jars</span><br><span class="line">drwxr-xr-x 4 1000 1000  4096 May  1  2019 kubernetes</span><br><span class="line">-rw-r--r-- 1 1000 1000 21316 May  1  2019 LICENSE</span><br><span class="line">drwxr-xr-x 2 1000 1000  4096 May  1  2019 licenses</span><br><span class="line">-rw-r--r-- 1 1000 1000 42919 May  1  2019 NOTICE</span><br><span class="line">drwxr-xr-x 7 1000 1000  4096 May  1  2019 python</span><br><span class="line">drwxr-xr-x 3 1000 1000  4096 May  1  2019 R</span><br><span class="line">-rw-r--r-- 1 1000 1000  3952 May  1  2019 README.md</span><br><span class="line">-rw-r--r-- 1 1000 1000   164 May  1  2019 RELEASE</span><br><span class="line">drwxr-xr-x 2 1000 1000  4096 May  1  2019 sbin</span><br><span class="line">drwxr-xr-x 2 1000 1000  4096 May  1  2019 yarn</span><br><span class="line">[root@container01 spark]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.构建spark镜像</span><br><span class="line">./bin/docker-image-tool.sh -r 172.21.230.89/doublehappy -t v2.4.3 build</span><br><span class="line">./bin/docker-image-tool.sh -r 172.21.230.89/doublehappy -t v2.4.3 push</span><br><span class="line"></span><br><span class="line">[root@container01 spark]<span class="comment"># ./bin/docker-image-tool.sh -r 172.21.230.89/doublehappy -t v2.4.3 build</span></span><br><span class="line">Sending build context to Docker daemon  259.1MB</span><br><span class="line">Step 1/15 : FROM openjdk:8-alpine</span><br><span class="line">8-alpine: Pulling from library/openjdk</span><br><span class="line">e7c96db7181b: Pull complete </span><br><span class="line">f910a506b6cb: Pull complete </span><br><span class="line">c2274a1a0e27: Pull complete </span><br><span class="line">Digest: sha256:94792824df2df33402f201713f932b58cb9de94a0cd524164a0f2283343547b3</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> openjdk:8-alpine</span><br><span class="line"> ---&gt; a3562aa0b991</span><br><span class="line">Step 2/15 : ARG spark_jars=jars</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 1ed1dcbc748b</span><br><span class="line">Removing intermediate container 1ed1dcbc748b</span><br><span class="line"> ---&gt; 4bf840b35abc</span><br><span class="line">Step 3/15 : ARG img_path=kubernetes/dockerfiles</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 2e0a10a5eeeb</span><br><span class="line">Removing intermediate container 2e0a10a5eeeb</span><br><span class="line"> ---&gt; e7b176887b3d</span><br><span class="line">Step 4/15 : ARG k8s_tests=kubernetes/tests</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 5d78a64b22a9</span><br><span class="line">Removing intermediate container 5d78a64b22a9</span><br><span class="line"> ---&gt; 7dda4f6f30d8</span><br><span class="line">Step 5/15 : RUN <span class="built_in">set</span> -ex &amp;&amp;     apk upgrade --no-cache &amp;&amp;     apk add --no-cache bash tini libc6-compat linux-pam nss &amp;&amp;     mkdir -p /opt/spark &amp;&amp;     mkdir -p /opt/spark/work-dir &amp;&amp;     touch /opt/spark/RELEASE &amp;&amp;     rm /bin/sh &amp;&amp;     ln -sv /bin/bash /bin/sh &amp;&amp;     <span class="built_in">echo</span> <span class="string">"auth required pam_wheel.so use_uid"</span> &gt;&gt; /etc/pam.d/su &amp;&amp;     chgrp root /etc/passwd &amp;&amp; chmod ug+rw /etc/passwd</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 52cff938c375</span><br><span class="line">+ apk upgrade --no-cache</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/community/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/11) Upgrading musl (1.1.20-r4 -&gt; 1.1.20-r5)</span><br><span class="line">(2/11) Upgrading libcrypto1.1 (1.1.1b-r1 -&gt; 1.1.1d-r2)</span><br><span class="line">(3/11) Upgrading libssl1.1 (1.1.1b-r1 -&gt; 1.1.1d-r2)</span><br><span class="line">(4/11) Upgrading musl-utils (1.1.20-r4 -&gt; 1.1.20-r5)</span><br><span class="line">(5/11) Upgrading libtasn1 (4.13-r0 -&gt; 4.14-r0)</span><br><span class="line">(6/11) Upgrading sqlite-libs (3.26.0-r3 -&gt; 3.28.0-r2)</span><br><span class="line">(7/11) Upgrading libbz2 (1.0.6-r6 -&gt; 1.0.6-r7)</span><br><span class="line">(8/11) Upgrading libjpeg-turbo (1.5.3-r4 -&gt; 1.5.3-r6)</span><br><span class="line">(9/11) Upgrading libcom_err (1.44.5-r0 -&gt; 1.44.5-r2)</span><br><span class="line">(10/11) Upgrading openjdk8-jre-base (8.212.04-r0 -&gt; 8.242.08-r0)</span><br><span class="line">(11/11) Upgrading openjdk8-jre (8.212.04-r0 -&gt; 8.242.08-r0)</span><br><span class="line">Executing busybox-1.29.3-r10.trigger</span><br><span class="line">Executing ca-certificates-20190108-r0.trigger</span><br><span class="line">Executing java-common-0.1-r0.trigger</span><br><span class="line">OK: 103 MiB <span class="keyword">in</span> 54 packages</span><br><span class="line">+ apk add --no-cache bash tini libc6-compat linux-pam nss</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/community/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/8) Installing ncurses-terminfo-base (6.1_p20190105-r0)</span><br><span class="line">(2/8) Installing ncurses-terminfo (6.1_p20190105-r0)</span><br><span class="line">(3/8) Installing ncurses-libs (6.1_p20190105-r0)</span><br><span class="line">(4/8) Installing readline (7.0.003-r1)</span><br><span class="line">(5/8) Installing bash (4.4.19-r1)</span><br><span class="line">Executing bash-4.4.19-r1.post-install</span><br><span class="line">(6/8) Installing libc6-compat (1.1.20-r5)</span><br><span class="line">(7/8) Installing linux-pam (1.3.0-r0)</span><br><span class="line">(8/8) Installing tini (0.18.0-r0)</span><br><span class="line">Executing busybox-1.29.3-r10.trigger</span><br><span class="line">OK: 113 MiB <span class="keyword">in</span> 62 packages</span><br><span class="line">+ mkdir -p /opt/spark</span><br><span class="line">+ mkdir -p /opt/spark/work-dir</span><br><span class="line">+ touch /opt/spark/RELEASE</span><br><span class="line">+ rm /bin/sh</span><br><span class="line">+ ln -sv /bin/bash /bin/sh</span><br><span class="line"><span class="string">'/bin/sh'</span> -&gt; <span class="string">'/bin/bash'</span></span><br><span class="line">+ <span class="built_in">echo</span> <span class="string">'auth required pam_wheel.so use_uid'</span></span><br><span class="line">+ chgrp root /etc/passwd</span><br><span class="line">+ chmod ug+rw /etc/passwd</span><br><span class="line">Removing intermediate container 52cff938c375</span><br><span class="line"> ---&gt; afcf7dcb4c3f</span><br><span class="line">Step 6/15 : COPY <span class="variable">$&#123;spark_jars&#125;</span> /opt/spark/jars</span><br><span class="line"> ---&gt; 89385fbda28a</span><br><span class="line">Step 7/15 : COPY bin /opt/spark/bin</span><br><span class="line"> ---&gt; aa3513116505</span><br><span class="line">Step 8/15 : COPY sbin /opt/spark/sbin</span><br><span class="line"> ---&gt; 47bfb4c55137</span><br><span class="line">Step 9/15 : COPY <span class="variable">$&#123;img_path&#125;</span>/spark/entrypoint.sh /opt/</span><br><span class="line"> ---&gt; 4e1505375576</span><br><span class="line">Step 10/15 : COPY examples /opt/spark/examples</span><br><span class="line"> ---&gt; 516d18d76b12</span><br><span class="line">Step 11/15 : COPY <span class="variable">$&#123;k8s_tests&#125;</span> /opt/spark/tests</span><br><span class="line"> ---&gt; 9f89a7c63732</span><br><span class="line">Step 12/15 : COPY data /opt/spark/data</span><br><span class="line"> ---&gt; 4f630068f4e7</span><br><span class="line">Step 13/15 : ENV SPARK_HOME /opt/spark</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 5a3c23422bf6</span><br><span class="line">Removing intermediate container 5a3c23422bf6</span><br><span class="line"> ---&gt; f2b96e5d55df</span><br><span class="line">Step 14/15 : WORKDIR /opt/spark/work-dir</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 7579f5960498</span><br><span class="line">Removing intermediate container 7579f5960498</span><br><span class="line"> ---&gt; c2b2f4e804be</span><br><span class="line">Step 15/15 : ENTRYPOINT [ <span class="string">"/opt/entrypoint.sh"</span> ]</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 54c8dd48bf2c</span><br><span class="line">Removing intermediate container 54c8dd48bf2c</span><br><span class="line"> ---&gt; 7d895d565b9d</span><br><span class="line">Successfully built 7d895d565b9d</span><br><span class="line">Successfully tagged 172.21.230.89/doublehappy/spark:v2.4.3</span><br><span class="line">Sending build context to Docker daemon  259.1MB</span><br><span class="line">Step 1/9 : ARG base_img</span><br><span class="line">Step 2/9 : FROM <span class="variable">$base_img</span></span><br><span class="line"> ---&gt; 7d895d565b9d</span><br><span class="line">Step 3/9 : WORKDIR /</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 676ac68db202</span><br><span class="line">Removing intermediate container 676ac68db202</span><br><span class="line"> ---&gt; 72e742d2ebe3</span><br><span class="line">Step 4/9 : RUN mkdir <span class="variable">$&#123;SPARK_HOME&#125;</span>/python</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> e7792928115a</span><br><span class="line">Removing intermediate container e7792928115a</span><br><span class="line"> ---&gt; 00148d7dc2ff</span><br><span class="line">Step 5/9 : RUN apk add --no-cache python &amp;&amp;     apk add --no-cache python3 &amp;&amp;     python -m ensurepip &amp;&amp;     python3 -m ensurepip &amp;&amp;     rm -r /usr/lib/python*/ensurepip &amp;&amp;     pip install --upgrade pip setuptools &amp;&amp;     rm -r /root/.cache</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 959225826ce7</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/community/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/3) Installing expat (2.2.8-r0)</span><br><span class="line">(2/3) Installing gdbm (1.13-r1)</span><br><span class="line">(3/3) Installing python2 (2.7.16-r2)</span><br><span class="line">Executing busybox-1.29.3-r10.trigger</span><br><span class="line">OK: 152 MiB <span class="keyword">in</span> 65 packages</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/community/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/2) Installing xz-libs (5.2.4-r0)</span><br><span class="line">(2/2) Installing python3 (3.6.9-r2)</span><br><span class="line">Executing busybox-1.29.3-r10.trigger</span><br><span class="line">OK: 205 MiB <span class="keyword">in</span> 67 packages</span><br><span class="line">Looking <span class="keyword">in</span> links: /tmp/tmpxKrRmR</span><br><span class="line">Collecting setuptools</span><br><span class="line">Collecting pip</span><br><span class="line">Installing collected packages: setuptools, pip</span><br><span class="line">Successfully installed pip-18.1 setuptools-40.6.2</span><br><span class="line">Looking <span class="keyword">in</span> links: /tmp/tmp83v437xu</span><br><span class="line">Requirement already satisfied: setuptools <span class="keyword">in</span> /usr/lib/python3.6/site-packages (40.6.2)</span><br><span class="line">Requirement already satisfied: pip <span class="keyword">in</span> /usr/lib/python3.6/site-packages (18.1)</span><br><span class="line">Collecting pip</span><br><span class="line">  Downloading https://files.pythonhosted.org/packages/54/0c/d01aa759fdc501a58f431eb594a17495f15b88da142ce14b5845662c13f3/pip-20.0.2-py2.py3-none-any.whl (1.4MB)</span><br><span class="line">Collecting setuptools</span><br><span class="line">  Downloading https://files.pythonhosted.org/packages/f9/d3/955738b20d3832dfa3cd3d9b07e29a8162edb480bf988332f5e6e48ca444/setuptools-44.0.0-py2.py3-none-any.whl (583kB)</span><br><span class="line">Installing collected packages: pip, setuptools</span><br><span class="line">  Found existing installation: pip 18.1</span><br><span class="line">    Uninstalling pip-18.1:</span><br><span class="line">      Successfully uninstalled pip-18.1</span><br><span class="line">  Found existing installation: setuptools 40.6.2</span><br><span class="line">    Uninstalling setuptools-40.6.2:</span><br><span class="line">      Successfully uninstalled setuptools-40.6.2</span><br><span class="line">Successfully installed pip-20.0.2 setuptools-44.0.0</span><br><span class="line">Removing intermediate container 959225826ce7</span><br><span class="line"> ---&gt; d803cfb93fb7</span><br><span class="line">Step 6/9 : COPY python/lib <span class="variable">$&#123;SPARK_HOME&#125;</span>/python/lib</span><br><span class="line"> ---&gt; a6ff2890f901</span><br><span class="line">Step 7/9 : ENV PYTHONPATH <span class="variable">$&#123;SPARK_HOME&#125;</span>/python/lib/pyspark.zip:<span class="variable">$&#123;SPARK_HOME&#125;</span>/python/lib/py4j-*.zip</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 239d8bd82251</span><br><span class="line">Removing intermediate container 239d8bd82251</span><br><span class="line"> ---&gt; a3899eac9c76</span><br><span class="line">Step 8/9 : WORKDIR /opt/spark/work-dir</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> afa1f7f2fba0</span><br><span class="line">Removing intermediate container afa1f7f2fba0</span><br><span class="line"> ---&gt; 0924048e54c9</span><br><span class="line">Step 9/9 : ENTRYPOINT [ <span class="string">"/opt/entrypoint.sh"</span> ]</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 3775107781f5</span><br><span class="line">Removing intermediate container 3775107781f5</span><br><span class="line"> ---&gt; 0807413bcdcd</span><br><span class="line">Successfully built 0807413bcdcd</span><br><span class="line">Successfully tagged 172.21.230.89/doublehappy/spark-py:v2.4.3</span><br><span class="line">Sending build context to Docker daemon  259.1MB</span><br><span class="line">Step 1/9 : ARG base_img</span><br><span class="line">Step 2/9 : FROM <span class="variable">$base_img</span></span><br><span class="line"> ---&gt; 7d895d565b9d</span><br><span class="line">Step 3/9 : WORKDIR /</span><br><span class="line"> ---&gt; Using cache</span><br><span class="line"> ---&gt; 72e742d2ebe3</span><br><span class="line">Step 4/9 : RUN mkdir <span class="variable">$&#123;SPARK_HOME&#125;</span>/R</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 7e96151ab7ee</span><br><span class="line">Removing intermediate container 7e96151ab7ee</span><br><span class="line"> ---&gt; 8a1fde912f50</span><br><span class="line">Step 5/9 : RUN apk add --no-cache R R-dev</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> f2a9cfb0ee09</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">fetch http://dl-cdn.alpinelinux.org/alpine/v3.9/community/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/60) Installing R-mathlib (3.5.1-r1)</span><br><span class="line">(2/60) Installing libice (1.0.9-r3)</span><br><span class="line">(3/60) Installing libuuid (2.33-r0)</span><br><span class="line">(4/60) Installing libsm (1.2.2-r2)</span><br><span class="line">(5/60) Installing libxt (1.1.5-r2)</span><br><span class="line">(6/60) Installing libxmu (1.1.2-r1)</span><br><span class="line">(7/60) Installing expat (2.2.8-r0)</span><br><span class="line">(8/60) Installing fontconfig (2.13.1-r0)</span><br><span class="line">(9/60) Installing pixman (0.34.0-r6)</span><br><span class="line">(10/60) Installing cairo (1.16.0-r1)</span><br><span class="line">(11/60) Installing nghttp2-libs (1.35.1-r1)</span><br><span class="line">(12/60) Installing libssh2 (1.9.0-r1)</span><br><span class="line">(13/60) Installing libcurl (7.64.0-r3)</span><br><span class="line">(14/60) Installing libintl (0.19.8.1-r4)</span><br><span class="line">(15/60) Installing libblkid (2.33-r0)</span><br><span class="line">(16/60) Installing libmount (2.33-r0)</span><br><span class="line">(17/60) Installing pcre (8.42-r1)</span><br><span class="line">(18/60) Installing glib (2.58.1-r3)</span><br><span class="line">(19/60) Installing libgomp (8.3.0-r0)</span><br><span class="line">(20/60) Installing icu-libs (62.1-r0)</span><br><span class="line">(21/60) Installing xz-libs (5.2.4-r0)</span><br><span class="line">(22/60) Installing libquadmath (8.3.0-r0)</span><br><span class="line">(23/60) Installing libgfortran (8.3.0-r0)</span><br><span class="line">(24/60) Installing openblas (0.3.3-r2)</span><br><span class="line">(25/60) Installing libxft (2.3.2-r3)</span><br><span class="line">(26/60) Installing fribidi (1.0.5-r1)</span><br><span class="line">(27/60) Installing graphite2 (1.3.12-r1)</span><br><span class="line">(28/60) Installing harfbuzz (2.2.0-r0)</span><br><span class="line">(29/60) Installing pango (1.42.4-r1)</span><br><span class="line">(30/60) Installing tiff (4.0.10-r3)</span><br><span class="line">(31/60) Installing R (3.5.1-r1)</span><br><span class="line">Executing R-3.5.1-r1.post-install</span><br><span class="line">*</span><br><span class="line">* If you want to install R packages from CRAN that contains native extensions,</span><br><span class="line">* <span class="keyword">then</span> you must also install R-dev.</span><br><span class="line">*</span><br><span class="line">(32/60) Installing binutils (2.31.1-r2)</span><br><span class="line">(33/60) Installing gmp (6.1.2-r1)</span><br><span class="line">(34/60) Installing isl (0.18-r0)</span><br><span class="line">(35/60) Installing libatomic (8.3.0-r0)</span><br><span class="line">(36/60) Installing mpfr3 (3.1.5-r1)</span><br><span class="line">(37/60) Installing mpc1 (1.0.3-r1)</span><br><span class="line">(38/60) Installing gcc (8.3.0-r0)</span><br><span class="line">(39/60) Installing gfortran (8.3.0-r0)</span><br><span class="line">(40/60) Installing icu (62.1-r0)</span><br><span class="line">(41/60) Installing pkgconf (1.6.0-r0)</span><br><span class="line">(42/60) Installing icu-dev (62.1-r0)</span><br><span class="line">(43/60) Installing zlib-dev (1.2.11-r1)</span><br><span class="line">(44/60) Installing libpng-dev (1.6.37-r0)</span><br><span class="line">(45/60) Installing make (4.2.1-r2)</span><br><span class="line">(46/60) Installing openblas-ilp64 (0.3.3-r2)</span><br><span class="line">(47/60) Installing openblas-dev (0.3.3-r2)</span><br><span class="line">(48/60) Installing libpcre16 (8.42-r1)</span><br><span class="line">(49/60) Installing libpcre32 (8.42-r1)</span><br><span class="line">(50/60) Installing libpcrecpp (8.42-r1)</span><br><span class="line">(51/60) Installing pcre-dev (8.42-r1)</span><br><span class="line">(52/60) Installing libhistory (7.0.003-r1)</span><br><span class="line">(53/60) Installing readline-dev (7.0.003-r1)</span><br><span class="line">(54/60) Installing xz-dev (5.2.4-r0)</span><br><span class="line">(55/60) Installing bzip2-dev (1.0.6-r7)</span><br><span class="line">(56/60) Installing openssl-dev (1.1.1d-r2)</span><br><span class="line">(57/60) Installing libssh2-dev (1.9.0-r1)</span><br><span class="line">(58/60) Installing nghttp2-dev (1.35.1-r1)</span><br><span class="line">(59/60) Installing curl-dev (7.64.0-r3)</span><br><span class="line">(60/60) Installing R-dev (3.5.1-r1)</span><br><span class="line">Executing busybox-1.29.3-r10.trigger</span><br><span class="line">Executing glib-2.58.1-r3.trigger</span><br><span class="line">OK: 483 MiB <span class="keyword">in</span> 122 packages</span><br><span class="line">Removing intermediate container f2a9cfb0ee09</span><br><span class="line"> ---&gt; 6ba3e96945f1</span><br><span class="line">Step 6/9 : COPY R <span class="variable">$&#123;SPARK_HOME&#125;</span>/R</span><br><span class="line"> ---&gt; 53c866b24bc7</span><br><span class="line">Step 7/9 : ENV R_HOME /usr/lib/R</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 353fcf7a3195</span><br><span class="line">Removing intermediate container 353fcf7a3195</span><br><span class="line"> ---&gt; 15f73ab74099</span><br><span class="line">Step 8/9 : WORKDIR /opt/spark/work-dir</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 6f8f14f50dd1</span><br><span class="line">Removing intermediate container 6f8f14f50dd1</span><br><span class="line"> ---&gt; f9ba7e7be95f</span><br><span class="line">Step 9/9 : ENTRYPOINT [ <span class="string">"/opt/entrypoint.sh"</span> ]</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> b45e8b5b55ca</span><br><span class="line">Removing intermediate container b45e8b5b55ca</span><br><span class="line"> ---&gt; e77ac91a3898</span><br><span class="line">Successfully built e77ac91a3898</span><br><span class="line">Successfully tagged 172.21.230.89/doublehappy/spark-r:v2.4.3</span><br><span class="line">[root@container01 spark]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看一下：</span><br><span class="line"></span><br><span class="line">[root@container01 ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY                                                        TAG                              IMAGE ID            CREATED             SIZE</span><br><span class="line">&lt;none&gt;                                                            &lt;none&gt;                           8a1fde912f50        12 seconds ago      371MB</span><br><span class="line">172.21.230.89/doublehappy/spark-py                                v2.4.3                           0807413bcdcd        15 seconds ago      462MB</span><br><span class="line">172.21.230.89/doublehappy/spark                                   v2.4.3                           7d895d565b9d        36 seconds ago      371MB</span><br><span class="line">mysql                                                             doublehappy5.7                   5c68aaadf900        4 days ago          434MB</span><br><span class="line">debian                                                            stretch-slim                     5174edbf8c39        9 days ago          55.3MB</span><br><span class="line">goharbor/chartmuseum-photon                                       v0.9.0-v1.10.0                   c8c98d2ac22b        2 months ago        128MB</span><br><span class="line">goharbor/harbor-migrator                                          v1.10.0                          9dd0c9228c79        2 months ago        362MB</span><br><span class="line">goharbor/redis-photon                                             v1.10.0                          6df66e5c1ca7        2 months ago        111MB</span><br><span class="line">goharbor/clair-adapter-photon                                     v1.0.1-v1.10.0                   4bdc58f374c2        2 months ago        61.6MB</span><br><span class="line">goharbor/clair-photon                                             v2.1.1-v1.10.0                   435d235c5000        2 months ago        171MB</span><br><span class="line">goharbor/notary-server-photon                                     v0.6.1-v1.10.0                   c7934c32e873        2 months ago        143MB</span><br><span class="line">goharbor/notary-signer-photon                                     v0.6.1-v1.10.0                   bb1a762155ab        2 months ago        140MB</span><br><span class="line">goharbor/harbor-registryctl                                       v1.10.0                          c550280445e6        2 months ago        104MB</span><br><span class="line">goharbor/registry-photon                                          v2.7.1-patch-2819-2553-v1.10.0   2115e08fa399        2 months ago        86.5MB</span><br><span class="line">goharbor/nginx-photon                                             v1.10.0                          f7ed614c3abc        2 months ago        44MB</span><br><span class="line">goharbor/harbor-log                                               v1.10.0                          fb15f6772e9a        2 months ago        82.3MB</span><br><span class="line">goharbor/harbor-jobservice                                        v1.10.0                          d6d4f2b125f6        2 months ago        142MB</span><br><span class="line">goharbor/harbor-core                                              v1.10.0                          f3a3065b3af2        2 months ago        128MB</span><br><span class="line">goharbor/harbor-portal                                            v1.10.0                          fbaeb1fdacad        2 months ago        52.1MB</span><br><span class="line">goharbor/harbor-db                                                v1.10.0                          634404a417cf        2 months ago        148MB</span><br><span class="line">goharbor/prepare                                                  v1.10.0                          927062458494        2 months ago        149MB</span><br><span class="line">openjdk                                                           8-alpine                         a3562aa0b991        9 months ago        105MB</span><br><span class="line">k8s.gcr.io/kube-controller-manager                                v1.13.2                          b9027a78d94c        13 months ago       146MB</span><br><span class="line">hackeruncle/kube-controller-manager                               v1.13.2                          b9027a78d94c        13 months ago       146MB</span><br><span class="line">hackeruncle/kube-proxy                                            v1.13.2                          01cfa56edcfc        13 months ago       80.3MB</span><br><span class="line">k8s.gcr.io/kube-proxy                                             v1.13.2                          01cfa56edcfc        13 months ago       80.3MB</span><br><span class="line">hackeruncle/kube-apiserver                                        v1.13.2                          177db4b8e93a        13 months ago       181MB</span><br><span class="line">k8s.gcr.io/kube-apiserver                                         v1.13.2                          177db4b8e93a        13 months ago       181MB</span><br><span class="line">hackeruncle/kube-scheduler                                        v1.13.2                          3193be46e0b3        13 months ago       79.6MB</span><br><span class="line">k8s.gcr.io/kube-scheduler                                         v1.13.2                          3193be46e0b3        13 months ago       79.6MB</span><br><span class="line">registry.cn-beijing.aliyuncs.com/minminmsn/kubernetes-dashboard   v1.10.1                          2b631cbc40bc        13 months ago       122MB</span><br><span class="line">172.21.230.89/doublehappy/hello-world                             v1                               fce289e99eb9        13 months ago       1.84kB</span><br><span class="line">container01/doublehappy/hello-world                               v2                               fce289e99eb9        13 months ago       1.84kB</span><br><span class="line">k8s.gcr.io/coredns                                                1.2.6                            f59dcacceff4        15 months ago       40MB</span><br><span class="line">hackeruncle/coredns                                               1.2.6                            f59dcacceff4        15 months ago       40MB</span><br><span class="line">hackeruncle/etcd                                                  3.2.24                           3cab8e1b9802        16 months ago       220MB</span><br><span class="line">k8s.gcr.io/etcd                                                   3.2.24                           3cab8e1b9802        16 months ago       220MB</span><br><span class="line">quay.io/coreos/flannel                                            v0.10.0-amd64                    f0fad859c909        2 years ago         44.6MB</span><br><span class="line">hackeruncle/pause                                                 3.1                              da86e6ba6ca1        2 years ago         742kB</span><br><span class="line">k8s.gcr.io/pause                                                  3.1                              da86e6ba6ca1        2 years ago         742kB</span><br><span class="line">172.21.230.89/doublehappy/mysql-slave                             v1.0                             b152e49ead77        3 years ago         426MB</span><br><span class="line">hackeruncle/mysql-slave                                           v1.0                             b152e49ead77        3 years ago         426MB</span><br><span class="line">172.21.230.89/doublehappy/mysql-master                            v1.0                             b73ad03215d5        3 years ago         426MB</span><br><span class="line">hackeruncle/mysql-master                                          v1.0                             b73ad03215d5        3 years ago         426MB</span><br><span class="line">[root@container01 ~]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY                                                        TAG                              IMAGE ID            CREATED              SIZE</span><br><span class="line">172.21.230.89/doublehappy/spark-r                                 v2.4.3                           e77ac91a3898        About a minute ago   757MB</span><br><span class="line">172.21.230.89/doublehappy/spark-py                                v2.4.3                           0807413bcdcd        About a minute ago   462MB</span><br><span class="line">172.21.230.89/doublehappy/spark                                   v2.4.3                           7d895d565b9d        About a minute ago   371MB</span><br><span class="line">mysql                                                             doublehappy5.7                   5c68aaadf900        4 days ago           434MB</span><br><span class="line">debian                                                            stretch-slim                     5174edbf8c39        9 days ago           55.3MB</span><br><span class="line">goharbor/chartmuseum-photon                                       v0.9.0-v1.10.0                   c8c98d2ac22b        2 months ago         128MB</span><br><span class="line">goharbor/harbor-migrator                                          v1.10.0                          9dd0c9228c79        2 months ago         362MB</span><br><span class="line">goharbor/redis-photon                                             v1.10.0                          6df66e5c1ca7        2 months ago         111MB</span><br><span class="line">goharbor/clair-adapter-photon                                     v1.0.1-v1.10.0                   4bdc58f374c2        2 months ago         61.6MB</span><br><span class="line">goharbor/clair-photon                                             v2.1.1-v1.10.0                   435d235c5000        2 months ago         171MB</span><br><span class="line">goharbor/notary-server-photon                                     v0.6.1-v1.10.0                   c7934c32e873        2 months ago         143MB</span><br><span class="line">goharbor/notary-signer-photon                                     v0.6.1-v1.10.0                   bb1a762155ab        2 months ago         140MB</span><br><span class="line">goharbor/harbor-registryctl                                       v1.10.0                          c550280445e6        2 months ago         104MB</span><br><span class="line">goharbor/registry-photon                                          v2.7.1-patch-2819-2553-v1.10.0   2115e08fa399        2 months ago         86.5MB</span><br><span class="line">goharbor/nginx-photon                                             v1.10.0                          f7ed614c3abc        2 months ago         44MB</span><br><span class="line">goharbor/harbor-log                                               v1.10.0                          fb15f6772e9a        2 months ago         82.3MB</span><br><span class="line">goharbor/harbor-jobservice                                        v1.10.0                          d6d4f2b125f6        2 months ago         142MB</span><br><span class="line">goharbor/harbor-core                                              v1.10.0                          f3a3065b3af2        2 months ago         128MB</span><br><span class="line">goharbor/harbor-portal                                            v1.10.0                          fbaeb1fdacad        2 months ago         52.1MB</span><br><span class="line">goharbor/harbor-db                                                v1.10.0                          634404a417cf        2 months ago         148MB</span><br><span class="line">goharbor/prepare                                                  v1.10.0                          927062458494        2 months ago         149MB</span><br><span class="line">openjdk                                                           8-alpine                         a3562aa0b991        9 months ago         105MB</span><br><span class="line">hackeruncle/kube-apiserver                                        v1.13.2                          177db4b8e93a        13 months ago        181MB</span><br><span class="line">k8s.gcr.io/kube-apiserver                                         v1.13.2                          177db4b8e93a        13 months ago        181MB</span><br><span class="line">hackeruncle/kube-proxy                                            v1.13.2                          01cfa56edcfc        13 months ago        80.3MB</span><br><span class="line">k8s.gcr.io/kube-proxy                                             v1.13.2                          01cfa56edcfc        13 months ago        80.3MB</span><br><span class="line">hackeruncle/kube-controller-manager                               v1.13.2                          b9027a78d94c        13 months ago        146MB</span><br><span class="line">k8s.gcr.io/kube-controller-manager                                v1.13.2                          b9027a78d94c        13 months ago        146MB</span><br><span class="line">hackeruncle/kube-scheduler                                        v1.13.2                          3193be46e0b3        13 months ago        79.6MB</span><br><span class="line">k8s.gcr.io/kube-scheduler                                         v1.13.2                          3193be46e0b3        13 months ago        79.6MB</span><br><span class="line">registry.cn-beijing.aliyuncs.com/minminmsn/kubernetes-dashboard   v1.10.1                          2b631cbc40bc        13 months ago        122MB</span><br><span class="line">172.21.230.89/doublehappy/hello-world                             v1                               fce289e99eb9        13 months ago        1.84kB</span><br><span class="line">container01/doublehappy/hello-world                               v2                               fce289e99eb9        13 months ago        1.84kB</span><br><span class="line">k8s.gcr.io/coredns                                                1.2.6                            f59dcacceff4        15 months ago        40MB</span><br><span class="line">hackeruncle/coredns                                               1.2.6                            f59dcacceff4        15 months ago        40MB</span><br><span class="line">k8s.gcr.io/etcd                                                   3.2.24                           3cab8e1b9802        16 months ago        220MB</span><br><span class="line">hackeruncle/etcd                                                  3.2.24                           3cab8e1b9802        16 months ago        220MB</span><br><span class="line">quay.io/coreos/flannel                                            v0.10.0-amd64                    f0fad859c909        2 years ago          44.6MB</span><br><span class="line">hackeruncle/pause                                                 3.1                              da86e6ba6ca1        2 years ago          742kB</span><br><span class="line">k8s.gcr.io/pause                                                  3.1                              da86e6ba6ca1        2 years ago          742kB</span><br><span class="line">172.21.230.89/doublehappy/mysql-slave                             v1.0                             b152e49ead77        3 years ago          426MB</span><br><span class="line">hackeruncle/mysql-slave                                           v1.0                             b152e49ead77        3 years ago          426MB</span><br><span class="line">172.21.230.89/doublehappy/mysql-master                            v1.0                             b73ad03215d5        3 years ago          426MB</span><br><span class="line">hackeruncle/mysql-master                                          v1.0                             b73ad03215d5        3 years ago          426MB</span><br><span class="line">[root@container01 ~]<span class="comment"># </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">push：到私服</span><br><span class="line"></span><br><span class="line">[root@container01 spark]<span class="comment"># ./bin/docker-image-tool.sh -r 172.21.230.89/doublehappy -t v2.4.3 push</span></span><br><span class="line">The push refers to repository [172.21.230.89/doublehappy/spark]</span><br><span class="line">64f8d2d5dc6b: Pushed </span><br><span class="line">8bad673cc19a: Pushed </span><br><span class="line">37a326771171: Pushed </span><br><span class="line">6334bffbbe5f: Pushed </span><br><span class="line">e47081996b74: Pushed </span><br><span class="line">897cdaf31bf7: Pushed </span><br><span class="line">261b1b5eb382: Pushed </span><br><span class="line">5add1f9f7507: Pushed </span><br><span class="line">ceaf9e1ebef5: Pushed </span><br><span class="line">9b9b7f3d56a0: Pushed </span><br><span class="line">f1b5933fe4b5: Pushed </span><br><span class="line">v2.4.3: digest: sha256:c8f97b50e7c325a9ad342afa7e796ae594f802306fae82b82d9622a462b32fa3 size: 2624</span><br><span class="line">The push refers to repository [172.21.230.89/doublehappy/spark-py]</span><br><span class="line">b161c5b08e39: Pushed </span><br><span class="line">abd349f5b3b6: Pushed </span><br><span class="line">e48b59a107cb: Pushed </span><br><span class="line">64f8d2d5dc6b: Mounted from doublehappy/spark </span><br><span class="line">8bad673cc19a: Mounted from doublehappy/spark </span><br><span class="line">37a326771171: Mounted from doublehappy/spark </span><br><span class="line">6334bffbbe5f: Mounted from doublehappy/spark </span><br><span class="line">e47081996b74: Mounted from doublehappy/spark </span><br><span class="line">897cdaf31bf7: Mounted from doublehappy/spark </span><br><span class="line">261b1b5eb382: Mounted from doublehappy/spark </span><br><span class="line">5add1f9f7507: Mounted from doublehappy/spark </span><br><span class="line">ceaf9e1ebef5: Mounted from doublehappy/spark </span><br><span class="line">9b9b7f3d56a0: Mounted from doublehappy/spark </span><br><span class="line">f1b5933fe4b5: Mounted from doublehappy/spark </span><br><span class="line">v2.4.3: digest: sha256:d466a3c0ac638e6c14048aabf6d48307f9c1ee691a8817ef5a40aeb24e420824 size: 3253</span><br><span class="line">The push refers to repository [172.21.230.89/doublehappy/spark-r]</span><br><span class="line">9f1cc9476665: Pushed </span><br><span class="line">4ef658c87c9d: Pushed </span><br><span class="line">13685a4568e4: Pushed </span><br><span class="line">64f8d2d5dc6b: Mounted from doublehappy/spark-py </span><br><span class="line">8bad673cc19a: Mounted from doublehappy/spark-py </span><br><span class="line">37a326771171: Mounted from doublehappy/spark-py </span><br><span class="line">6334bffbbe5f: Mounted from doublehappy/spark-py </span><br><span class="line">e47081996b74: Mounted from doublehappy/spark-py </span><br><span class="line">897cdaf31bf7: Mounted from doublehappy/spark-py </span><br><span class="line">261b1b5eb382: Mounted from doublehappy/spark-py </span><br><span class="line">5add1f9f7507: Mounted from doublehappy/spark-py </span><br><span class="line">ceaf9e1ebef5: Mounted from doublehappy/spark-py </span><br><span class="line">9b9b7f3d56a0: Mounted from doublehappy/spark-py </span><br><span class="line">f1b5933fe4b5: Mounted from doublehappy/spark-py </span><br><span class="line">v2.4.3: digest: sha256:9aad314aae767666e0fa6605753ab95d758b7286ef63fca6e7bab5732cbe4030 size: 3255</span><br><span class="line">[root@container01 spark]<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://img-blog.csdnimg.cn/20200211154658637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line">3.创建secret</span><br><span class="line">kubectl create secret docker-registry sparkkey \</span><br><span class="line">--namespace=default \</span><br><span class="line">--docker-server=172.21.230.89 \</span><br><span class="line">--docker-username=admin \</span><br><span class="line">--docker-password=Harbor12345 </span><br><span class="line"></span><br><span class="line">[root@container01 spark]# kubectl create secret docker-registry sparkkey \</span><br><span class="line">&gt; --namespace=default \</span><br><span class="line">&gt; --docker-server=172.21.230.89 \</span><br><span class="line">&gt; --docker-username=admin \</span><br><span class="line">&gt; --docker-password=Harbor12345 </span><br><span class="line">secret/sparkkey created</span><br><span class="line">[root@container01 spark]# </span><br><span class="line"></span><br><span class="line">4.创建serviceAccount及 绑定clusterrolebinding</span><br><span class="line">kubectl create serviceaccount spark</span><br><span class="line"></span><br><span class="line">kubectl create clusterrolebinding spark-role --clusterrole=edit \</span><br><span class="line">--serviceaccount=default:spark --namespace=default</span><br><span class="line"></span><br><span class="line">[root@container01 spark]# kubectl create serviceaccount spark</span><br><span class="line">serviceaccount/spark created</span><br><span class="line">[root@container01 spark]# kubectl create clusterrolebinding spark-role --clusterrole=edit \</span><br><span class="line">&gt; --serviceaccount=default:spark --namespace=default</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/spark-role created</span><br><span class="line">[root@container01 spark]# </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5. 提交之前 查看 k8s port :k8s-apiserver-port (看spark官网)</span><br><span class="line"></span><br><span class="line">[root@container01 spark]# kubectl cluster-info</span><br><span class="line">Kubernetes master is running at https://172.21.230.89:6443</span><br><span class="line">KubeDNS is running at https://172.21.230.89:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><br><span class="line"></span><br><span class="line">To further debug and diagnose cluster problems, use &apos;kubectl cluster-info dump&apos;.</span><br><span class="line">[root@container01 spark]# </span><br><span class="line"></span><br><span class="line">即：https://172.21.230.89:6443</span><br><span class="line"></span><br><span class="line">bin/spark-submit \</span><br><span class="line">--master k8s://https://172.21.230.89:6443 \</span><br><span class="line">--deploy-mode cluster \</span><br><span class="line">--name spark-pi \</span><br><span class="line">--class org.apache.spark.examples.SparkPi \</span><br><span class="line">--conf spark.executor.instances=2 \</span><br><span class="line">--conf spark.kubernetes.container.image.pullSecrets=sparkkey \</span><br><span class="line">--conf spark.kubernetes.container.image=172.21.230.89/doublehappy/spark:v2.4.3 \</span><br><span class="line">--conf spark.kubernetes.authenticate.driver.serviceAccountName=spark \</span><br><span class="line">--conf spark.kubernetes.driver.pod.name=spark-pi-driver \</span><br><span class="line">local:///opt/spark/examples/jars/spark-examples_2.11-2.4.3.jar</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">这些参数spark官网都有 下面又截图</span><br><span class="line"></span><br><span class="line">[root@container01 spark]# bin/spark-submit \</span><br><span class="line">&gt; --master k8s://https://172.21.230.89:6443 \</span><br><span class="line">&gt; --deploy-mode cluster \</span><br><span class="line">&gt; --name spark-pi \</span><br><span class="line">&gt; --class org.apache.spark.examples.SparkPi \</span><br><span class="line">&gt; --conf spark.executor.instances=2 \</span><br><span class="line">&gt; --conf spark.kubernetes.container.image.pullSecrets=sparkkey \</span><br><span class="line">&gt; --conf spark.kubernetes.container.image=172.21.230.89/doublehappy/spark:v2.4.3 \</span><br><span class="line">&gt; --conf spark.kubernetes.authenticate.driver.serviceAccountName=spark \</span><br><span class="line">&gt; --conf spark.kubernetes.driver.pod.name=spark-pi-driver \</span><br><span class="line">&gt; local:///opt/spark/examples/jars/spark-examples_2.11-2.4.3.jar</span><br><span class="line">log4j:WARN No appenders could be found for logger (io.fabric8.kubernetes.client.Config).</span><br><span class="line">log4j:WARN Please initialize the log4j system properly.</span><br><span class="line">log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.</span><br><span class="line">Using Spark&apos;s default log4j profile: org/apache/spark/log4j-defaults.properties</span><br><span class="line">20/02/11 16:16:49 INFO LoggingPodStatusWatcherImpl: State changed, new state: </span><br><span class="line">         pod name: spark-pi-driver</span><br><span class="line">         namespace: default</span><br><span class="line">         labels: spark-app-selector -&gt; spark-961842d41a564fc3ba906855f8ee4b57, spark-role -&gt; driver</span><br><span class="line">         pod uid: d9ab6302-4ca6-11ea-adad-00163e041ece</span><br><span class="line">         creation time: 2020-02-11T08:16:48Z</span><br><span class="line">         service account name: spark</span><br><span class="line">         volumes: spark-local-dir-1, spark-conf-volume, spark-token-9hgdn</span><br><span class="line">         node name: N/A</span><br><span class="line">         start time: N/A</span><br><span class="line">         container images: N/A</span><br><span class="line">         phase: Pending</span><br><span class="line">         status: []</span><br><span class="line">20/02/11 16:16:49 INFO LoggingPodStatusWatcherImpl: State changed, new state: </span><br><span class="line">         pod name: spark-pi-driver</span><br><span class="line">         namespace: default</span><br><span class="line">         labels: spark-app-selector -&gt; spark-961842d41a564fc3ba906855f8ee4b57, spark-role -&gt; driver</span><br><span class="line">         pod uid: d9ab6302-4ca6-11ea-adad-00163e041ece</span><br><span class="line">         creation time: 2020-02-11T08:16:48Z</span><br><span class="line">         service account name: spark</span><br><span class="line">         volumes: spark-local-dir-1, spark-conf-volume, spark-token-9hgdn</span><br><span class="line">         node name: container02</span><br><span class="line">         start time: N/A</span><br><span class="line">         container images: N/A</span><br><span class="line">         phase: Pending</span><br><span class="line">         status: []</span><br><span class="line">20/02/11 16:16:49 INFO LoggingPodStatusWatcherImpl: State changed, new state: </span><br><span class="line">         pod name: spark-pi-driver</span><br><span class="line">         namespace: default</span><br><span class="line">         labels: spark-app-selector -&gt; spark-961842d41a564fc3ba906855f8ee4b57, spark-role -&gt; driver</span><br><span class="line">         pod uid: d9ab6302-4ca6-11ea-adad-00163e041ece</span><br><span class="line">         creation time: 2020-02-11T08:16:48Z</span><br><span class="line">         service account name: spark</span><br><span class="line">         volumes: spark-local-dir-1, spark-conf-volume, spark-token-9hgdn</span><br><span class="line">         node name: container02</span><br><span class="line">         start time: 2020-02-11T08:16:49Z</span><br><span class="line">         container images: 172.21.230.89/doublehappy/spark:v2.4.3</span><br><span class="line">         phase: Pending</span><br><span class="line">         status: [ContainerStatus(containerID=null, image=172.21.230.89/doublehappy/spark:v2.4.3, imageID=, lastState=ContainerState(running=null, terminated=null, waiting=null, additionalProperties=&#123;&#125;), name=spark-kubernetes-driver, ready=false, restartCount=0, state=ContainerState(running=null, terminated=null, waiting=ContainerStateWaiting(message=null, reason=ContainerCreating, additionalProperties=&#123;&#125;), additionalProperties=&#123;&#125;), additionalProperties=&#123;&#125;)]</span><br><span class="line">20/02/11 16:16:49 INFO Client: Waiting for application spark-pi to finish...</span><br><span class="line">20/02/11 16:16:59 INFO LoggingPodStatusWatcherImpl: State changed, new state: </span><br><span class="line">         pod name: spark-pi-driver</span><br><span class="line">         namespace: default</span><br><span class="line">         labels: spark-app-selector -&gt; spark-961842d41a564fc3ba906855f8ee4b57, spark-role -&gt; driver</span><br><span class="line">         pod uid: d9ab6302-4ca6-11ea-adad-00163e041ece</span><br><span class="line">         creation time: 2020-02-11T08:16:48Z</span><br><span class="line">         service account name: spark</span><br><span class="line">         volumes: spark-local-dir-1, spark-conf-volume, spark-token-9hgdn</span><br><span class="line">         node name: container02</span><br><span class="line">         start time: 2020-02-11T08:16:49Z</span><br><span class="line">         container images: 172.21.230.89/doublehappy/spark:v2.4.3</span><br><span class="line">         phase: Running</span><br><span class="line">         status: [ContainerStatus(containerID=docker://80f7f9b25b92c8995b99de55ad1bcd47d46e04bbfe794f09b394a8516468ac2b, image=172.21.230.89/doublehappy/spark:v2.4.3, imageID=docker-pullable://172.21.230.89/doublehappy/spark@sha256:c8f97b50e7c325a9ad342afa7e796ae594f802306fae82b82d9622a462b32fa3, lastState=ContainerState(running=null, terminated=null, waiting=null, additionalProperties=&#123;&#125;), name=spark-kubernetes-driver, ready=true, restartCount=0, state=ContainerState(running=ContainerStateRunning(startedAt=2020-02-11T08:16:59Z, additionalProperties=&#123;&#125;), terminated=null, waiting=null, additionalProperties=&#123;&#125;), additionalProperties=&#123;&#125;)]</span><br><span class="line">20/02/11 16:17:34 INFO LoggingPodStatusWatcherImpl: State changed, new state: </span><br><span class="line">         pod name: spark-pi-driver</span><br><span class="line">         namespace: default</span><br><span class="line">         labels: spark-app-selector -&gt; spark-961842d41a564fc3ba906855f8ee4b57, spark-role -&gt; driver</span><br><span class="line">         pod uid: d9ab6302-4ca6-11ea-adad-00163e041ece</span><br><span class="line">         creation time: 2020-02-11T08:16:48Z</span><br><span class="line">         service account name: spark</span><br><span class="line">         volumes: spark-local-dir-1, spark-conf-volume, spark-token-9hgdn</span><br><span class="line">         node name: container02</span><br><span class="line">         start time: 2020-02-11T08:16:49Z</span><br><span class="line">         container images: 172.21.230.89/doublehappy/spark:v2.4.3</span><br><span class="line">         phase: Succeeded</span><br><span class="line">         status: [ContainerStatus(containerID=docker://80f7f9b25b92c8995b99de55ad1bcd47d46e04bbfe794f09b394a8516468ac2b, image=172.21.230.89/doublehappy/spark:v2.4.3, imageID=docker-pullable://172.21.230.89/doublehappy/spark@sha256:c8f97b50e7c325a9ad342afa7e796ae594f802306fae82b82d9622a462b32fa3, lastState=ContainerState(running=null, terminated=null, waiting=null, additionalProperties=&#123;&#125;), name=spark-kubernetes-driver, ready=false, restartCount=0, state=ContainerState(running=null, terminated=ContainerStateTerminated(containerID=docker://80f7f9b25b92c8995b99de55ad1bcd47d46e04bbfe794f09b394a8516468ac2b, exitCode=0, finishedAt=2020-02-11T08:17:34Z, message=null, reason=Completed, signal=null, startedAt=2020-02-11T08:16:59Z, additionalProperties=&#123;&#125;), waiting=null, additionalProperties=&#123;&#125;), additionalProperties=&#123;&#125;)]</span><br><span class="line">20/02/11 16:17:34 INFO LoggingPodStatusWatcherImpl: Container final statuses:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         Container name: spark-kubernetes-driver</span><br><span class="line">         Container image: 172.21.230.89/doublehappy/spark:v2.4.3</span><br><span class="line">         Container state: Terminated</span><br><span class="line">         Exit code: 0</span><br><span class="line">20/02/11 16:17:34 INFO Client: Application spark-pi finished.</span><br><span class="line">20/02/11 16:17:34 INFO ShutdownHookManager: Shutdown hook called</span><br><span class="line">20/02/11 16:17:34 INFO ShutdownHookManager: Deleting directory /tmp/spark-41d1f84f-677e-4476-9cdc-a277ebe96dfa</span><br><span class="line">[root@container01 spark]# </span><br><span class="line"></span><br><span class="line">查看一下：</span><br><span class="line">[root@container01 ~]# kubectl get  all</span><br><span class="line">NAME                  READY   STATUS      RESTARTS   AGE</span><br><span class="line">pod/spark-pi-driver   0/1     Completed   0          92s</span><br><span class="line"></span><br><span class="line">NAME                                        TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)             AGE</span><br><span class="line">service/kubernetes                          ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP             26h</span><br><span class="line">service/spark-pi-1581409007077-driver-svc   ClusterIP   None         &lt;none&gt;        7078/TCP,7079/TCP   91s</span><br><span class="line">[root@container01 ~]#</span><br><span class="line"></span><br><span class="line">查看spark log：</span><br><span class="line"></span><br><span class="line">[root@container01 ~]# kubectl logs -f spark-pi-driver</span><br><span class="line">++ id -u</span><br><span class="line">+ myuid=0</span><br><span class="line">++ id -g</span><br><span class="line">+ mygid=0</span><br><span class="line">+ set +e</span><br><span class="line">++ getent passwd 0</span><br><span class="line">+ uidentry=root:x:0:0:root:/root:/bin/ash</span><br><span class="line">+ set -e</span><br><span class="line">+ &apos;[&apos; -z root:x:0:0:root:/root:/bin/ash &apos;]&apos;</span><br><span class="line">+ SPARK_K8S_CMD=driver</span><br><span class="line">+ case &quot;$SPARK_K8S_CMD&quot; in</span><br><span class="line">+ shift 1</span><br><span class="line">+ SPARK_CLASSPATH=&apos;:/opt/spark/jars/*&apos;</span><br><span class="line">+ grep SPARK_JAVA_OPT_</span><br><span class="line">+ sort -t_ -k4 -n</span><br><span class="line">+ sed &apos;s/[^=]*=\(.*\)/\1/g&apos;</span><br><span class="line">+ env</span><br><span class="line">+ readarray -t SPARK_EXECUTOR_JAVA_OPTS</span><br><span class="line">+ &apos;[&apos; -n &apos;&apos; &apos;]&apos;</span><br><span class="line">+ &apos;[&apos; -n &apos;&apos; &apos;]&apos;</span><br><span class="line">+ PYSPARK_ARGS=</span><br><span class="line">+ &apos;[&apos; -n &apos;&apos; &apos;]&apos;</span><br><span class="line">+ R_ARGS=</span><br><span class="line">+ &apos;[&apos; -n &apos;&apos; &apos;]&apos;</span><br><span class="line">+ &apos;[&apos; &apos;&apos; == 2 &apos;]&apos;</span><br><span class="line">+ &apos;[&apos; &apos;&apos; == 3 &apos;]&apos;</span><br><span class="line">+ case &quot;$SPARK_K8S_CMD&quot; in</span><br><span class="line">+ CMD=(&quot;$SPARK_HOME/bin/spark-submit&quot; --conf &quot;spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS&quot; --deploy-mode client &quot;$@&quot;)</span><br><span class="line">+ exec /sbin/tini -s -- /opt/spark/bin/spark-submit --conf spark.driver.bindAddress=10.244.1.5 --deploy-mode client --properties-file /opt/spark/conf/spark.properties --class org.apache.spark.examples.SparkPi spark-internal</span><br><span class="line">20/02/11 08:17:00 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</span><br><span class="line">Using Spark&apos;s default log4j profile: org/apache/spark/log4j-defaults.properties</span><br><span class="line">20/02/11 08:17:01 INFO SparkContext: Running Spark version 2.4.3</span><br><span class="line">20/02/11 08:17:01 INFO SparkContext: Submitted application: Spark Pi</span><br><span class="line">20/02/11 08:17:01 INFO SecurityManager: Changing view acls to: root</span><br><span class="line">20/02/11 08:17:01 INFO SecurityManager: Changing modify acls to: root</span><br><span class="line">20/02/11 08:17:01 INFO SecurityManager: Changing view acls groups to: </span><br><span class="line">20/02/11 08:17:01 INFO SecurityManager: Changing modify acls groups to: </span><br><span class="line">20/02/11 08:17:01 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()</span><br><span class="line">20/02/11 08:17:01 INFO Utils: Successfully started service &apos;sparkDriver&apos; on port 7078.</span><br><span class="line">20/02/11 08:17:01 INFO SparkEnv: Registering MapOutputTracker</span><br><span class="line">20/02/11 08:17:01 INFO SparkEnv: Registering BlockManagerMaster</span><br><span class="line">20/02/11 08:17:01 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information</span><br><span class="line">20/02/11 08:17:01 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up</span><br><span class="line">20/02/11 08:17:01 INFO DiskBlockManager: Created local directory at /var/data/spark-6753da05-ab60-4e01-bafd-70e0141b47f2/blockmgr-f9c8a8f5-32c4-42b4-bb3b-3ec9686c04f5</span><br><span class="line">20/02/11 08:17:01 INFO MemoryStore: MemoryStore started with capacity 413.9 MB</span><br><span class="line">20/02/11 08:17:01 INFO SparkEnv: Registering OutputCommitCoordinator</span><br><span class="line">20/02/11 08:17:01 INFO Utils: Successfully started service &apos;SparkUI&apos; on port 4040.</span><br><span class="line">20/02/11 08:17:01 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://spark-pi-1581409007077-driver-svc.default.svc:4040</span><br><span class="line">20/02/11 08:17:01 INFO SparkContext: Added JAR file:///opt/spark/examples/jars/spark-examples_2.11-2.4.3.jar at spark://spark-pi-1581409007077-driver-svc.default.svc:7078/jars/spark-examples_2.11-2.4.3.jar with timestamp 1581409021888</span><br><span class="line">20/02/11 08:17:03 INFO ExecutorPodsAllocator: Going to request 2 executors from Kubernetes.</span><br><span class="line">20/02/11 08:17:03 INFO Utils: Successfully started service &apos;org.apache.spark.network.netty.NettyBlockTransferService&apos; on port 7079.</span><br><span class="line">20/02/11 08:17:03 INFO NettyBlockTransferService: Server created on spark-pi-1581409007077-driver-svc.default.svc:7079</span><br><span class="line">20/02/11 08:17:03 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy</span><br><span class="line">20/02/11 08:17:03 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, spark-pi-1581409007077-driver-svc.default.svc, 7079, None)</span><br><span class="line">20/02/11 08:17:03 INFO BlockManagerMasterEndpoint: Registering block manager spark-pi-1581409007077-driver-svc.default.svc:7079 with 413.9 MB RAM, BlockManagerId(driver, spark-pi-1581409007077-driver-svc.default.svc, 7079, None)</span><br><span class="line">20/02/11 08:17:03 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, spark-pi-1581409007077-driver-svc.default.svc, 7079, None)</span><br><span class="line">20/02/11 08:17:03 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, spark-pi-1581409007077-driver-svc.default.svc, 7079, None)</span><br><span class="line">20/02/11 08:17:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (10.244.2.4:56814) with ID 1</span><br><span class="line">20/02/11 08:17:14 INFO BlockManagerMasterEndpoint: Registering block manager 10.244.2.4:37098 with 413.9 MB RAM, BlockManagerId(1, 10.244.2.4, 37098, None)</span><br><span class="line">20/02/11 08:17:33 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after waiting maxRegisteredResourcesWaitingTime: 30000(ms)</span><br><span class="line">20/02/11 08:17:33 INFO SparkContext: Starting job: reduce at SparkPi.scala:38</span><br><span class="line">20/02/11 08:17:33 INFO DAGScheduler: Got job 0 (reduce at SparkPi.scala:38) with 2 output partitions</span><br><span class="line">20/02/11 08:17:33 INFO DAGScheduler: Final stage: ResultStage 0 (reduce at SparkPi.scala:38)</span><br><span class="line">20/02/11 08:17:33 INFO DAGScheduler: Parents of final stage: List()</span><br><span class="line">20/02/11 08:17:33 INFO DAGScheduler: Missing parents: List()</span><br><span class="line">20/02/11 08:17:33 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[1] at map at SparkPi.scala:34), which has no missing parents</span><br><span class="line">20/02/11 08:17:33 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 1936.0 B, free 413.9 MB)</span><br><span class="line">20/02/11 08:17:33 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 1256.0 B, free 413.9 MB)</span><br><span class="line">20/02/11 08:17:33 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on spark-pi-1581409007077-driver-svc.default.svc:7079 (size: 1256.0 B, free: 413.9 MB)</span><br><span class="line">20/02/11 08:17:33 INFO SparkContext: Created broadcast 0 from broadcast at DAGScheduler.scala:1161</span><br><span class="line">20/02/11 08:17:33 INFO DAGScheduler: Submitting 2 missing tasks from ResultStage 0 (MapPartitionsRDD[1] at map at SparkPi.scala:34) (first 15 tasks are for partitions Vector(0, 1))</span><br><span class="line">20/02/11 08:17:33 INFO TaskSchedulerImpl: Adding task set 0.0 with 2 tasks</span><br><span class="line">20/02/11 08:17:33 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0, 10.244.2.4, executor 1, partition 0, PROCESS_LOCAL, 7885 bytes)</span><br><span class="line">20/02/11 08:17:34 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 10.244.2.4:37098 (size: 1256.0 B, free: 413.9 MB)</span><br><span class="line">20/02/11 08:17:34 INFO TaskSetManager: Starting task 1.0 in stage 0.0 (TID 1, 10.244.2.4, executor 1, partition 1, PROCESS_LOCAL, 7885 bytes)</span><br><span class="line">20/02/11 08:17:34 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 534 ms on 10.244.2.4 (executor 1) (1/2)</span><br><span class="line">20/02/11 08:17:34 INFO TaskSetManager: Finished task 1.0 in stage 0.0 (TID 1) in 27 ms on 10.244.2.4 (executor 1) (2/2)</span><br><span class="line">20/02/11 08:17:34 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool </span><br><span class="line">20/02/11 08:17:34 INFO DAGScheduler: ResultStage 0 (reduce at SparkPi.scala:38) finished in 0.814 s</span><br><span class="line">20/02/11 08:17:34 INFO DAGScheduler: Job 0 finished: reduce at SparkPi.scala:38, took 0.868531 s</span><br><span class="line">Pi is roughly 3.139475697378487</span><br><span class="line">20/02/11 08:17:34 INFO SparkUI: Stopped Spark web UI at http://spark-pi-1581409007077-driver-svc.default.svc:4040</span><br><span class="line">20/02/11 08:17:34 INFO KubernetesClusterSchedulerBackend: Shutting down all executors</span><br><span class="line">20/02/11 08:17:34 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Asking each executor to shut down</span><br><span class="line">20/02/11 08:17:34 WARN ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed (this is expected if the application is shutting down.)</span><br><span class="line">20/02/11 08:17:34 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!</span><br><span class="line">20/02/11 08:17:34 INFO MemoryStore: MemoryStore cleared</span><br><span class="line">20/02/11 08:17:34 INFO BlockManager: BlockManager stopped</span><br><span class="line">20/02/11 08:17:34 INFO BlockManagerMaster: BlockManagerMaster stopped</span><br><span class="line">20/02/11 08:17:34 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</span><br><span class="line">20/02/11 08:17:34 INFO SparkContext: Successfully stopped SparkContext</span><br><span class="line">20/02/11 08:17:34 INFO ShutdownHookManager: Shutdown hook called</span><br><span class="line">20/02/11 08:17:34 INFO ShutdownHookManager: Deleting directory /var/data/spark-6753da05-ab60-4e01-bafd-70e0141b47f2/spark-67555fc1-109a-46a0-bff7-1c14b972cfe4</span><br><span class="line">20/02/11 08:17:34 INFO ShutdownHookManager: Deleting directory /tmp/spark-7f09677c-5829-434e-b74d-af0f0c021571</span><br><span class="line">[root@container01 ~]# </span><br><span class="line"></span><br><span class="line">结果：使用kubectl logs -f spark-pi-driver 是可以看到的</span><br><span class="line"></span><br><span class="line">Pi is roughly 3.1451757258786293</span><br><span class="line">20/02/11 08:23:35 INFO SparkUI: Stopped Spark web UI at http://spark-pi-1581409376163-driver-svc.default.svc:4040</span><br><span class="line">20/02/11 08:23:35 INFO KubernetesClusterSchedulerBacke</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">1.上面的spark命令在 spark官网的基础上添加了 很多参数  官网上也能找到</span><br><span class="line">2.机器上要 先部署 jdk</span><br><span class="line"></span><br><span class="line">如果没有加 ：</span><br><span class="line">spark 出错了 使用 </span><br><span class="line">	1.kubectl get all   先看看有没有error</span><br><span class="line">	2.再查看spark （pod name） 通过  </span><br><span class="line">	  kubectl logs -f spark-pi-driver  </span><br><span class="line">	3.如果出问题了 先 delete</span><br><span class="line">		kubectl delete [pod name] </span><br><span class="line">		[root@container01 ~]# kubectl  delete pod/spark-pi-driver </span><br><span class="line">			pod &quot;spark-pi-driver&quot; deleted</span><br><span class="line">		[root@container01 ~]# 		</span><br><span class="line">   4.再排错 重新提交</span><br></pre></td></tr></table></figure></div>
<p><img src="https://img-blog.csdnimg.cn/20200211162525671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTU1NzUxMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
  </div>
  <div class="article-nav-block">
    
      <a href="/2020/01/05/Kudu-Impala%E6%95%85%E9%9A%9C%E6%A1%88%E4%BE%8B01-double-happy/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">Kudu+Impala故障案例01--double_happy</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    <link rel="stylesheet" href="/css/gitment.css"> 
<script src="/js/gitment.js"></script>

<div id="gitmentContainer"></div>

<script>
var gitment = new Gitment({
  owner: '',
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/images/default-avatar.jpg" title="图片来自网络"></img>
    <h3 class="avatar-name">
      
        DoubleHappy
      
    </h3>
    <p class="avatar-slogan">
      特别耐撕的大数据，资深的打酱油攻城狮。
    </p>
  </div>
</div>


  
    

  
    

  
    
  
    
  <div class="widget-box">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/04/27/k8s-Spark-doublehappy/">k8s-Spark-doublehappy</a>
          </li>
        
          <li>
            <a href="/2020/01/05/Kudu-Impala%E6%95%85%E9%9A%9C%E6%A1%88%E4%BE%8B01-double-happy/">Kudu+Impala故障案例01--double_happy</a>
          </li>
        
          <li>
            <a href="/2020/01/05/Flink04-double-happy/">Flink04--double_happy</a>
          </li>
        
          <li>
            <a href="/2020/01/05/Flink03-double-happy/">Flink03--double_happy</a>
          </li>
        
          <li>
            <a href="/2020/01/05/Flink02-double-happy/">Flink02--double_happy</a>
          </li>
        
      </ul>
    </div>
  </div>

  
      <div class="widget-box">
    <h3 class="widget-title">友链</h3>
    <div class="widget">
      
        <a style="display: block;" href="https://liverrrr.fun/archives" title target='_blank'
        >一路眼瞎</a>
      
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2020 DoubleHappy &nbsp;&nbsp;
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity" target="_blank" rel="noopener">antiquity</a>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">不蒜子告之   阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>


<script src="/js/script.js"></script>



    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/archives" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>